<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>L I G H T R U N N E R</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
html,body{margin:0;padding:0;overflow:hidden;height:100%;background:black;font-family:'Share Tech Mono', monospace;}
canvas{display:block;}
#menu{
  position:absolute;top:0;left:0;width:100%;height:100%;
  display:flex;flex-direction:column;justify-content:center;align-items:center;
  background: rgba(0,0,0,0.85); z-index:10;color:white;
}
#menu input,#menu select,#menu button{
  margin:8px;padding:12px;font-size:18px;
  background:#111;border:2px solid cyan;color:white;border-radius:6px;
  text-shadow:0 0 5px cyan;
  cursor:pointer;transition:0.2s;
}
#menu input:focus,#menu select:focus,#menu button:hover{
  border-color:#0ff;text-shadow:0 0 10px #0ff;outline:none;
}
#title{
  font-size:72px;color:cyan;font-weight:bold;
  animation:bob 1.5s infinite alternate;
  margin-bottom:20px;
  text-shadow:0 0 15px cyan,0 0 30px cyan;
}
@keyframes bob{0%{transform:translateY(0px);}100%{transform:translateY(20px);}}
#hud{position:absolute;top:10px;left:10px;color:white;font-weight:bold;font-size:20px;z-index:5;}
</style>
</head>
<body>
<div id="menu">
  <div id="title">L I G H T R U N N E R</div>
  <input id="playerName" placeholder="Enter your name" maxlength="12"/>
  <select id="bikeColor">
    <option value="cyan">Cyan</option>
    <option value="magenta">Magenta</option>
    <option value="yellow">Yellow</option>
    <option value="lime">Lime</option>
    <option value="blue">Blue</option>
    <option value="red">Red</option>
    <option value="green">Green</option>
  </select>
  <button id="startBtn">Run!</button>
  <div style="margin-top:10px;font-size:14px;opacity:0.8;">
    Controls: A/D to change lane, W/S to speed up/slow down, Space to jump
  </div>
</div>
<div id="hud"></div>
<canvas id="gameCanvas"></canvas>

<script>
const canvas=document.getElementById('gameCanvas');
const ctx=canvas.getContext('2d');
let width=canvas.width=window.innerWidth;
let height=canvas.height=window.innerHeight;
const hud=document.getElementById('hud');

let gameRunning=false;
let distance=0,score=0,speed=10;
const GRAVITY=1;
const LANE_COUNT=3,LANE_WIDTH=width/4;

let player,obstacles=[],keys={a:false,d:false,w:false,s:false,space:false};

// --- Player Class ---
class Player{
  constructor(color){
    this.color=color;
    this.lane=1; 
    this.x=this.getX();
    this.y=height-150;
    this.z=0;
    this.vy=0;
    this.onGround=true;
    this.alive=true;
  }
  getX(){ return width/2 + (this.lane-1)*LANE_WIDTH; }
  move(){
    if(!this.alive) return;

    // Lane movement with smooth transition
    if(keys.a && this.lane>0) this.lane--;
    if(keys.d && this.lane<LANE_COUNT-1) this.lane++;
    this.x += (this.getX() - this.x) * 0.2;

    // Jump
    if(keys.space && this.onGround){
      this.vy=-20; 
      this.onGround=false; 
      keys.space=false;
    }
    this.vy += GRAVITY;
    this.y += this.vy;
    if(this.y>=height-150){this.y=height-150; this.vy=0; this.onGround=true;}

    // Move forward
    this.z += speed;

    // Collision
    obstacles.forEach(obs=>{
      if(obs.lane===this.lane && this.z>obs.z && this.z<obs.z+obs.depth && this.y>height-150-obs.height){
        this.alive=false;
      }
    });
  }
  draw(){
    let scale = 1 - (this.z/5000); // simulate perspective
    if(scale<0.2) scale=0.2;

    // Draw bike
    let rectWidth = 40*scale;
    let rectHeight = 30*scale;
    let rectX = this.x - rectWidth/2;
    let rectY = this.y - rectHeight;

    ctx.fillStyle=this.color;
    ctx.shadowBlur=20; ctx.shadowColor=this.color;
    ctx.fillRect(rectX,rectY,rectWidth,rectHeight);

    ctx.beginPath();
    ctx.moveTo(this.x, rectY-20*scale);
    ctx.lineTo(rectX, rectY);
    ctx.lineTo(rectX+rectWidth, rectY);
    ctx.closePath();
    ctx.fill();
    ctx.shadowBlur=0;
  }
}

// --- Obstacle Class ---
class Obstacle{
  constructor(lane,z){
    this.lane=lane;
    this.z=z;
    this.height=60;
    this.depth=60;
  }
  draw(){
    let scale = 1 - ((this.z - player.z)/5000);
    if(scale<0.2) scale=0.2;
    let x = width/2 + (this.lane-1)*LANE_WIDTH - (LANE_WIDTH/2)*scale;
    let y = height-150 - this.height*scale;
    ctx.fillStyle='red';
    ctx.fillRect(x,y,LANE_WIDTH*scale,this.height*scale);
  }
}

// --- Game Functions ---
function startGame(name,color){
  gameRunning=true; distance=0;score=0; speed=10;
  player=new Player(color);
  obstacles=[];
  loop();
}

function generateObstacles(){
  if(Math.random()<0.03){
    let lane=Math.floor(Math.random()*LANE_COUNT);
    let z = player.z + width + Math.random()*1000;
    obstacles.push(new Obstacle(lane,z));
  }
}

function update(){
  if(!player.alive) return;
  player.move();
  distance += speed;
  score = Math.floor(distance/10);
  generateObstacles();
}

function draw(){
  ctx.clearRect(0,0,width,height);

  // Draw lanes
  for(let lane=0; lane<LANE_COUNT; lane++){
    ctx.fillStyle='rgba(255,255,255,0.05)';
    ctx.fillRect(width/2 + (lane-1)*LANE_WIDTH - LANE_WIDTH/2,0,LANE_WIDTH,height);
  }

  // Draw obstacles
  obstacles.forEach(o=>o.draw());

  // Draw player
  player.draw();

  hud.innerText=`Score: ${score}`;
}

function loop(){
  if(!gameRunning) return;
  requestAnimationFrame(loop);
  update();
  draw();
}

// --- Input ---
document.addEventListener('keydown',e=>{
  if(e.key==='a')keys.a=true;
  if(e.key==='d')keys.d=true;
  if(e.key==='w')keys.w=true;
  if(e.key==='s')keys.s=true;
  if(e.key===' ')keys.space=true;
});
document.addEventListener('keyup',e=>{
  if(e.key==='a')keys.a=false;
  if(e.key==='d')keys.d=false;
  if(e.key==='w')keys.w=false;
  if(e.key==='s')keys.s=false;
  if(e.key===' ')keys.space=false;
});

// --- Start button ---
document.getElementById('startBtn').addEventListener('click',()=>{
  const name=document.getElementById('playerName').value||'Runner';
  const color=document.getElementById('bikeColor').value||'cyan';
  document.getElementById('menu').style.display='none';
  startGame(name,color);
});

window.addEventListener('resize',()=>{width=canvas.width=window.innerWidth;height=canvas.height=window.innerHeight;});
</script>
</body>
</html>
